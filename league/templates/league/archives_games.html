{% extends "league/base.html" %}
{% load league_tags wgo_tags%}

{% block title %}Archives - Games {% if game %}- {{game.black}} vs {{game.white}} {%endif %}{% endblock %}
{% block extra_head_js %}
<script type="text/javascript">
function load_game(game_id) {
  var url = "/league/game/json/" + game_id

  $.ajax({
    type: "GET",
    url: "/league/game/json/" + game_id,
    dataType: "json",
    success: processData,
    error: function(){ alert("failed"); }
});

function processData(data)
{
    document.getElementById("game_infos").innerHTML= data.game_infos ;
    var elem = document.getElementById("player");
    var player = new WGo.BasicPlayer(elem, {
      sgf: data.sgf
      });
    window.history.pushState('page2', 'Title', data.permalink);
    document.getElementById("game-header").innerHTML= ' - ' + data.white + ' vs ' + data.black;
    document.title ='Archives - Games - '+ data.white + ' vs ' + data.black + ' - Open Study Room';
};
return false;};
</script>
{% endblock %}
{% block content %}
<nav class="navbar navbar-default">
<ul class="nav navbar-nav navbar-left">
  <li><a href="{% url 'league:archives' %}">Leagues</a></li>
  <li><a href="{% url 'league:players'  %}">Players</a></li>
  <li class="active"><a href="{% url 'league:games'  %}">Games</a></li>
</ul>
<ul class="nav navbar-nav navbar-right" style="margin-right:5px;">
  <li><a href="{% url 'league:event' %}">Current league</a></li>
  <li class="active"><a href="{% url 'league:archives' %}">Archives</a></li>
</ul>
</nav>
<div class ="row">
<div class="col-md-4">
  <div id ="game_infos">
    {% if game %}
  {% include "league/includes/game_info.html"  %}
    {% endif %}
</div>
<div class="panel panel-default">
<div class="panel-heading">Games</div>
{% include "league/includes/games.html" with games=games %}
</div>
</div>

<div class="col-md-8">
  {% if game %}
  <div id="player" data-wgo="{{ game.sgf.sgf_text | prepare_sgf}}" >
    </div>
    {% else %}
    <div id="player"></div>
  {% endif %}
{% endblock %}
</div>
{% block extra_js %}
<script type="text/javascript" src="https://cdn.datatables.net/v/bs/dt-1.10.13/fh-3.1.2/r-2.1.0/sc-1.4.2/datatables.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
$('#game-table').DataTable({"bLengthChange": false ,"dom":'<"H"lr>ft<"F"ip>',"order": [[ 0, "desc" ]]});
} );
</script>
{% endblock %}
